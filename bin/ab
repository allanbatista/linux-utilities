#!/usr/bin/env bash
set -euo pipefail

SCRIPT_PATH="$(readlink -f -- "${BASH_SOURCE[0]}")"
SCRIPT_DIR="$(dirname -- "$SCRIPT_PATH")"

show_help() {
    echo "ab - Allan Batista's CLI utilities"
    echo ""
    echo "Usage: ab <category|command> [arguments...]"
    echo ""
    echo "Categories:"
    echo "  git               Git utilities powered by LLM"
    echo "  util              General utilities"
    echo ""
    echo "Commands:"
    echo "  prompt            Send context to LLM (OpenRouter)"
    echo "  config            Manage configuration"
    echo ""
    echo "Examples:"
    echo "  ab git auto-commit -a -y"
    echo "  ab git pr-description -c"
    echo "  ab util passgenerator 16"
    echo "  ab prompt -p 'hello'"
    echo "  ab config show"
    echo ""
    echo "Use 'ab <category> help' to see category commands"
    echo "Use 'ab <category> <command> --help' for more details"
}

# If no arguments, show help
if [ $# -eq 0 ]; then
    show_help
    exit 0
fi

COMMAND="$1"
shift

case "$COMMAND" in
    help|-h|--help)
        show_help
        ;;
    git|util)
        exec "$SCRIPT_DIR/ab-$COMMAND" "$@"
        ;;
    prompt|config)
        exec "$SCRIPT_DIR/ab-$COMMAND" "$@"
        ;;
    *)
        echo "Error: unknown command '$COMMAND'"
        echo "Use 'ab help' to see available commands"
        exit 1
        ;;
esac
